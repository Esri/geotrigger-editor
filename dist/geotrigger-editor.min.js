/*! geotrigger-editor 2013-07-18 */
GTEdit.module("Layout",function(a,b,c){a.Map=c.Marionette.Layout.extend({template:"#template-gt-map",ui:{},events:{},initialize:function(){console.log("Layout.Map initialize")},onRender:function(){console.log("Layout.Map onRender")}}),a.Controls=c.Marionette.Layout.extend({template:"#template-gt-controls",ui:{tools:".gt-draw-tool"},events:{"click .gt-draw-tool":"switchDrawTool"},initialize:function(){console.log("Layout.Controls initialize")},onRender:function(){console.log("Layout.Controls onRender")},switchDrawlTool:function(a){console.log(a.target)}}),a.Panel=c.Marionette.ItemView.extend({template:"#template-gt-panel",ui:{input:"#gt-new",search:"#gt-search"},events:{"click #gt-new":"showNewTriggerForm","keypress #gt-search":"onSearchKeypress"},showNewTriggerForm:function(){},onSearchKeypress:function(a){var b=13,c=this.ui.search.val().trim();a.which===b&&c&&this.searchTriggers(c)},searchTriggers:function(){}})});var GTEdit=new Backbone.Marionette.Application;GTEdit.addRegions({main:"#gt-panel",controls:"#gt-controls",map:"#gt-map"}),GTEdit.on("initialize:after",function(){Backbone.history.start()}),function(){function a(a){this.el=a.el||"#gt-editor",this.map=null,this.addMap()}a.prototype.addMap=function(){function a(a){var b=a.accuracy/2;L.marker(a.latlng).addTo(c).bindPopup("You are within "+b+" meters from this point").openPopup(),L.circle(a.latlng,b).addTo(c)}function b(a){alert(a.message)}$(this.el).append('<div id="gt-map"/>');var c=this.map=L.map("gt-map");return c.zoomControl.setPosition("topright"),L.esri.basemapLayer("Imagery",{zIndex:1,detectRetina:!0}).addTo(c),L.esri.basemapLayer("ImageryLabels",{zIndex:3}).addTo(c),c.on("locationfound",a),c.on("locationerror",b),c.locate({setView:!0,maxZoom:16}),this},window.GeotriggerEditor=a}();